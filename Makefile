
APP_NAME ?= $(shell basename `pwd`)
APP_PORT = 8080

all: build docker

build:
	go build -o malware_detector ./server/server.go

docker: Dockerfile
	echo "creating docker image" 
	docker build -f Dockerfile -t $(APP_NAME) .

run:
	echo "running $(APP_NAME) docker" 
	docker run -d -p $(APP_PORT):8080 --name "$(APP_NAME)" $(APP_NAME)

stop:
	echo "stopping $(APP_NAME) docker"
	docker stop $(APP_NAME) 
	docker rm $(APP_NAME) 

clean:
	echo "cleaning"
	rm malware_detector 
	go clean 

